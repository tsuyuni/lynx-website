{/*
* This file is generated by @lynx-js/tool-typedoc.
* Do not edit this file directly.
* @generated
*/}

{/* Import all components as Lynx to allow dynamic lookup in TSDoc writings. */}
import * as Lynx from '@lynx';

[react](/api/react/index.mdx) / built-in-macros

# 組み込みマクロ

`@lynx-js/react` パッケージは、`__BACKGROUND__` や `__MAIN_THREAD__` などの組み込みマクロ定義を処理します。コンパイル時に、`false` 条件を持つコードブロックは自動的に削除されます。

## `__BACKGROUND__`

- 型: `boolean`
- 目的: バックグラウンドスレッド環境でのコード実行を制御します。コンパイル後のバックグラウンドスレッドコードに保持すべきコードセグメントを指定するために使用します。

### 使用例

#### 関数コンポーネントでの使用

`App` コンポーネントを使用した例を以下に示します。

```tsx
import { noop } from 'lodash-es';
import { useEffect } from '@lynx-js/react';

function App() {
  const showToast = __BACKGROUND__
    ? () => {
        bridge.call('showToast', {
          message: t('toast'),
          icon: 'success',
        });
      }
    : noop;

  useEffect(showToast, []);
  return <view />;
}
```

コンパイル後、このコードは次のように変換されます。

- バックグラウンドスレッド (コンパイル中間ディレクトリ内の `background.js`):

```tsx
function App() {
  const showToast = () => {
    bridge.call('showToast', {
      message: t('toast'),
      icon: 'success',
    });
  };
  useEffect(showToast, []);
  return createSnapshotInstance(__snapshot_5ab440, null, []);
}
```

- メインスレッド (コンパイル中間ディレクトリ内の `main-thread.js`):

```tsx
function App() {
  const showToast = noop_default;

  useEffect();
  return createSnapshotInstance(__snapshot_5ab440, null, []);
}
```

#### クラスコンポーネントでの使用

`Conversations` コンポーネントを使用した例を以下に示します。

```tsx
import { AppLoggerFactory } from '../utils/appLoggerFactory';

class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
    if (__BACKGROUND__) {
      this.appLogger = AppLoggerFactory();
    }
  }
}
```

コンパイル後、このコードは次のように変換されます。

- バックグラウンドスレッド (コンパイル中間ディレクトリ内の `background.js`):

```tsx
class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
    this.appLogger = AppLoggerFactory();
  }
}
```

- メインスレッド (コンパイル中間ディレクトリ内の `main-thread.js`):

```tsx
class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
  }
}
```

## `__MAIN_THREAD__`

- 型: `boolean`
- 目的: メインスレッド環境でのコード実行を制御します。コンパイル後のメインスレッドコードに保持すべきコードセグメントを指定するために使用します。 

### 使用例

#### 関数コンポーネントでの使用

`App` コンポーネントを使用した例を以下に示します。

```tsx
import { noop } from 'lodash-es';
import { useEffect } from '@lynx-js/react';

function App() {
  const showToast = !__MAIN_THREAD__
    ? () => {
        bridge.call('showToast', {
          message: t('toast'),
          icon: 'success',
        });
      }
    : noop;

  useEffect(showToast, []);
  return <view />;
}
```

コンパイル後、このコードは次のように変換されます。

- バックグラウンドスレッド (コンパイル中間ディレクトリ内の `background.js`):

```tsx
function App() {
  const showToast = () => {
    bridge.call('showToast', {
      message: t('toast'),
      icon: 'success',
    });
  };
  useEffect(showToast, []);
  return createSnapshotInstance(__snapshot_5ab440, null, []);
}
```

- メインスレッド (コンパイル中間ディレクトリ内の `main-thread.js`):

```tsx
function App() {
  const showToast = noop_default;

  useEffect();
  return createSnapshotInstance(__snapshot_5ab440, null, []);
}
```

#### クラスコンポーネントでの使用

`Conversations` コンポーネントを使用した例を以下に示します。

```tsx
import { AppLoggerFactory } from '../utils/appLoggerFactory';

class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
    if (!__MAIN_THREAD__) {
      this.appLogger = AppLoggerFactory();
    }
  }
}
```

コンパイル後、このコードは次のように変換されます。

- バックグラウンドスレッド (コンパイル中間ディレクトリ内の `background.js`):

```tsx
class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
    this.appLogger = AppLoggerFactory();
  }
}
```

- メインスレッド (コンパイル中間ディレクトリ内の `main-thread.js`):

```tsx
class Conversations extends Component<Props, State> {
  appLogger: AppLogger;

  constructor(props: Props) {
    super(props);
    this.state = {
      showConversationItemAction: false,
      loading: true,
    };
  }
}
```
